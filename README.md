# 股票监控系统

一个基于 Next.js 的实时股票监控系统，支持多种监控指标和智能通知功能。

## ✨ 主要功能

### 🕐 智能交易时间管理
- **交易时间**：工作日 9:30-15:00
- **自动暂停**：非交易时间自动暂停监控和数据更新
- **状态显示**：实时显示当前交易状态和下次交易时间

### 📊 多指标监控
- **价格监控**：监控股票价格达到目标值
- **溢价监控**：监控溢价达到设定阈值
- **涨跌幅监控**：监控当日涨跌幅达到阈值
- **多指标支持**：一个任务可以同时监听多个指标
- **灵活条件**：支持高于/低于目标值的监控条件

### 🔔 智能通知系统
- **桌面通知**：达到条件时自动发送桌面通知
- **每日重置**：每个交易日自动重置通知状态
- **防重复**：避免重复发送相同通知
- **权限管理**：自动请求和管理通知权限

### 🔐 用户认证系统
- **邮箱验证**：支持邮箱注册和登录
- **Google OAuth**：支持 Google 账号登录
- **验证码**：安全的邮箱验证码系统
- **会话管理**：安全的用户会话管理

### 🎯 实时数据更新
- **自动更新**：交易时间内每10秒自动更新数据
- **实时显示**：当前价格、涨跌幅、溢价、更新时间
- **高亮提示**：触发条件的监控项会高亮显示
- **状态管理**：支持启用/禁用单个监控和指标

## 🚀 技术特性

- **Next.js 15**：最新的 React 框架
- **TypeScript**：完整的类型安全
- **Tailwind CSS**：现代化的 UI 设计
- **NextAuth.js**：完整的身份验证解决方案
- **Resend**：专业的邮件发送服务
- **PostgreSQL**：可靠的数据库存储
- **实时数据**：集成股票 API 获取实时数据
- **响应式设计**：支持各种设备尺寸

## 📦 安装和运行

### 环境要求
- Node.js 18+ 
- npm 或 yarn
- PostgreSQL 数据库
- Resend 邮件服务账号

### 环境变量设置

在项目根目录创建 `.env.local` 文件，包含以下配置：

```bash
# 数据库连接
DATABASE_URL="postgresql://username:password@localhost:5432/stock_monitor"

# NextAuth 配置
NEXTAUTH_URL="http://localhost:3000"
NEXTAUTH_SECRET="your-secret-key-here"

# Google OAuth 配置
GOOGLE_CLIENT_ID="your-google-client-id"
GOOGLE_CLIENT_SECRET="your-google-client-secret"

# Resend 邮件服务
RESEND_API_KEY="your-resend-api-key"

# 股票 API（可选）
STOCK_API_KEY="your-stock-api-key"
```

### 数据库设置

1. 创建 PostgreSQL 数据库
2. 运行数据库初始化脚本：
```bash
node setup-db.cjs
```

### 安装依赖
```bash
npm install
```

### 开发模式运行
```bash
npm run dev
```

### 构建生产版本
```bash
npm run build
npm start
```

## 🎮 使用说明

### 用户注册和登录
1. 访问 `/auth` 页面进行注册或登录
2. 支持邮箱密码注册和 Google OAuth 登录
3. 邮箱注册需要验证码验证
4. 登录后可以访问完整的监控功能

### 添加监控
1. 点击"添加监控"按钮
2. 输入股票代码（支持 sz/sh 前缀）
3. 点击搜索自动获取股票名称
4. 添加监控指标（可添加多个）
5. 设置监控条件和阈值
6. 保存监控配置

### 监控管理
- **编辑监控**：点击编辑按钮修改配置
- **暂停监控**：使用开关控制监控状态
- **删除监控**：点击删除按钮移除监控
- **指标管理**：单独启用/禁用每个指标

### 通知设置
- 首次使用时会请求通知权限
- 支持浏览器桌面通知
- 每个交易日自动重置通知状态

## 🔧 配置说明

### 股票代码格式
- 深圳股票：`sz` + 股票代码（如：`sz159509`）
- 上海股票：`sh` + 股票代码（如：`sh510300`）
- 系统会自动添加前缀

### 监控阈值设置
- **价格监控**：精确到 0.0001 元
- **溢价监控**：精确到 0.0001%
- **涨跌幅监控**：精确到 0.0001%

### 数据更新频率
- 交易时间：每 10 秒自动更新
- 非交易时间：暂停更新
- 支持手动更新数据

## 📱 界面特性

- **响应式设计**：适配桌面和移动设备
- **深色模式**：支持系统主题切换
- **实时状态**：显示交易时间和系统状态
- **直观操作**：简洁的卡片式布局
- **状态反馈**：清晰的成功/错误提示

## 🔒 数据安全

- **用户认证**：安全的用户身份验证
- **数据库存储**：使用 PostgreSQL 安全存储数据
- **邮件验证**：邮箱验证码确保用户真实性
- **会话管理**：安全的用户会话管理
- **隐私保护**：不会泄露用户个人信息

## 🚧 注意事项

- 需要设置正确的环境变量
- 需要配置 PostgreSQL 数据库
- 需要 Resend 邮件服务账号
- 仅在交易时间内进行监控
- 需要浏览器支持桌面通知
- 股票数据来源于公开 API
- 建议在交易时间内使用以获得最佳体验

## 🤝 贡献

欢迎提交 Issue 和 Pull Request 来改进这个项目！

## �� 许可证

MIT License
